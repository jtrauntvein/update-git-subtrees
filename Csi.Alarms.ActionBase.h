/* Csi.Alarms.ActionBase.h

   Copyright (C) 2012, 2012 Campbell Scientific, Inc.

   Written by: Jon Trauntvein 
   Date Begun: Wednesday 26 September 2012
   Last Change: Thursday 04 October 2012
   Last Commit: $Date: 2012-10-04 10:59:32 -0600 (Thu, 04 Oct 2012) $
   Last Changed by: $Author: jon $

*/

#ifndef Csi_Alarms_ActionBase_h
#define Csi_Alarms_ActionBase_h

#include "Csi.Alarms.ActionTemplateBase.h"


namespace Csi
{
   namespace Alarms
   {
      ////////////////////////////////////////////////////////////
      // class ActionBase
      //
      // Defines a base class for actions that will be taken when an alarm
      // enters a triggered state. 
      ////////////////////////////////////////////////////////////
      class Alarm;
      class Condition;
      class ActionBase
      {
      protected:
         ////////////////////////////////////////////////////////////
         // template
         ////////////////////////////////////////////////////////////
         ActionTemplateBase *action_template;
         
      public:
         ////////////////////////////////////////////////////////////
         // constructor
         ////////////////////////////////////////////////////////////
         ActionBase(ActionTemplateBase *action_template_):
            action_template(action_template_)
         { }

         ////////////////////////////////////////////////////////////
         // destructor
         ////////////////////////////////////////////////////////////
         virtual ~ActionBase()
         { }

         ////////////////////////////////////////////////////////////
         // execute
         ////////////////////////////////////////////////////////////
         virtual void execute() = 0;

         ////////////////////////////////////////////////////////////
         // get_alarm
         ////////////////////////////////////////////////////////////
         Alarm *get_alarm();

         ////////////////////////////////////////////////////////////
         // get_template
         ////////////////////////////////////////////////////////////
         ActionTemplateBase *get_template()
         { return action_template; }
         
         ////////////////////////////////////////////////////////////
         // get_condition
         ////////////////////////////////////////////////////////////
         Condition *get_condition()
         { return action_template->get_condition(); }

         ////////////////////////////////////////////////////////////
         // get_last_error
         ////////////////////////////////////////////////////////////
         virtual StrAsc const &get_last_error() = 0;

         ////////////////////////////////////////////////////////////
         // describe_log
         ////////////////////////////////////////////////////////////
         virtual void describe_log(Xml::Element &elem) = 0;
         
      protected:
         ////////////////////////////////////////////////////////////
         // report_complete
         ////////////////////////////////////////////////////////////
         void report_complete();
      };
   };
};


#endif
